# Otter

基于数据库增量日志解析，准实时同步到本机房或异地机房的mysql/oracle数据库.



## 其他

### 在 Otter 中数据冲突有两种：

* 行冲突，
  * 可以通过对比数据修改时间来解决，或者是在冲突时回源查询覆盖目标库；
* 字段冲突。
  * 对于字段冲突，我们可以根据修改时间覆盖或把多个修改动作合并，比如 a 机房 -1，b 机房 -1，合并后就是 -2，以此来实现数据的最终一致性。

> 但是请注意，这种合并方式并不适合库存一类的数据管理，因为这样会出现超卖现象。如果有类似需求，建议用长期缓存解决。





### 注意事项

* 为了保证数据的完整性，变更表结构时，我们一般会先从从库修改表结构，因此在设置 Otter 同步时，建议将 pipeline 同步设置为忽略 DDL 同步错误；
* 数据库表新增字段时，只能在表结尾新增，不能删除老字段，并且建议先把新增字段同步到目标库，然后再同步到主库，因为只有这样才不会丢数据；
* 双向同步的表在新增字段时不要有默认值，同时 Otter 不支持没有主键的表同步。
* 主键，ULID



### 问题

* 如果 Otter 同步的链路是环形的，那么如何保证数据不会一直循环同步下去？